<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<title>éº»é›€ æ–™é‡‘ãƒ»ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ï½œPOãƒ»TORO</title>
<meta name="description" content="ãƒãƒ»ãƒˆãƒ­å¥å…¨éº»é›€ã®æ–™é‡‘è¡¨ã¨æ–™é‡‘ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ã€‚ã†ã¾ç‰¹åˆ¥æ–™é‡‘ï¼ˆ19:00ï½21:00 åŒå“æ–™ãªã—ï¼‰ã«ã‚‚å¯¾å¿œã€‚">
<style>
:root{
  --bg:#fbf7fa;
  --card:#ffffff;
  --text:#2f2622;
  --muted:#5f5f5f;
  --accent:#de3f7b;
  --border:#ffd6e7;
  --grad1:#f6b7d2;
  --grad2:#a9d6f7;
}
*{box-sizing:border-box;}
body{
  margin:0;
  font-family:"Noto Sans JP","Hiragino Kaku Gothic ProN","Meiryo",system-ui,-apple-system,Segoe UI,sans-serif;
  background:var(--bg);
  color:var(--text);
  line-height:1.85;
}
header{
  padding:34px 18px 18px;
  text-align:center;
  color:#fff;
  background:linear-gradient(135deg,var(--grad1),var(--grad2));
}
header .badge{
  display:inline-block;
  padding:6px 12px;
  border:1px solid rgba(255,255,255,.45);
  border-radius:999px;
  font-weight:800;
  background:rgba(255,255,255,.12);
}
header h1{
  margin:12px 0 6px;
  font-size:1.45rem;
  font-weight:900;
  letter-spacing:.01em;
}
header p{margin:0; font-weight:700; opacity:.98;}

.nav{
  max-width:860px;
  margin:0 auto;
  padding:10px 12px 0;
  display:flex;
  gap:10px;
  flex-wrap:wrap;
}
.nav a{
  text-decoration:none;
  font-weight:900;
  color:#fff;
  padding:10px 12px;
  border-radius:999px;
  background:rgba(222,63,123,.72);
  border:1px solid rgba(255,255,255,.28);
}
.nav a.secondary{
  background:rgba(100,116,139,.75);
}

main{
  max-width:860px;
  margin:0 auto;
  padding:12px 12px 26px;
}
section{
  background:rgba(255,255,255,.92);
  border:1px solid var(--border);
  border-radius:16px;
  padding:22px 18px;
  margin:12px 0;
  box-shadow:0 10px 22px rgba(0,0,0,.05);
}
h2{
  margin:0 0 12px;
  color:var(--accent);
  font-size:1.12rem;
  font-weight:900;
  letter-spacing:.01em;
  padding-bottom:8px;
  border-bottom:1px dashed rgba(222,63,123,.25);
}
p{margin:0 0 10px;}
ul{margin:8px 0 0 1.2em; padding:0;}
.note{
  margin-top:8px;
  color:var(--muted);
  font-size:.95rem;
}

.pricebox{
  border:1px dashed var(--border);
  border-radius:14px;
  padding:12px;
  background:#fffafc;
}
.price{ font-weight:900; }

.example{
  margin-top:10px;
  padding:10px 12px;
  border-left:4px solid var(--accent);
  background:#fff7fb;
  border-radius:10px;
}

/* ===== æ–™é‡‘ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ ===== */
.sim{
  background:#ffffff;
  border:1px solid var(--border);
  border-radius:16px;
  padding:14px 14px 12px;
}
.sim-grid{
  display:grid;
  grid-template-columns:1fr 1fr 1fr;
  gap:10px;
}
@media (max-width:720px){
  .sim-grid{ grid-template-columns:1fr; }
}
.field{
  background:#fffafc;
  border:1px dashed var(--border);
  border-radius:14px;
  padding:10px;
}
.field label{
  display:block;
  font-weight:900;
  margin-bottom:6px;
}
.field input, .field select{
  width:100%;
  padding:10px 12px;
  border-radius:12px;
  border:1px solid #f1c2d7;
  font-size:16px;
  outline:none;
  background:#fff;
}
.field input:focus, .field select:focus{
  border-color:rgba(222,63,123,.55);
  box-shadow:0 0 0 4px rgba(222,63,123,.12);
}
.field .mini{ color:var(--muted); font-size:.92rem; margin-top:6px; }

.sim-actions{
  display:flex;
  gap:10px;
  margin-top:10px;
  flex-wrap:wrap;
}
.btn{
  border:0;
  cursor:pointer;
  padding:12px 14px;
  border-radius:14px;
  font-weight:900;
  color:#fff;
  background:linear-gradient(135deg,#ff7aa8,#ffb3cd);
  transition:transform .2s ease, box-shadow .2s ease, filter .2s ease;
}
.btn:hover{ transform:translateY(-2px); box-shadow:0 10px 18px rgba(0,0,0,.12); filter:saturate(1.05) brightness(1.02); }
.btn:active{ transform:translateY(-1px); box-shadow:0 8px 14px rgba(0,0,0,.10); }
.btn.secondary{ background:linear-gradient(135deg,#94a3b8,#64748b); }

/* åˆ†ãƒ—ãƒªã‚»ãƒƒãƒˆ */
.presets{
  margin-top:10px;
  display:flex;
  flex-wrap:wrap;
  gap:8px;
}
.pbtn{
  border:1px solid rgba(222,63,123,.25);
  background:#fff7fb;
  color:#7a2a43;
  font-weight:900;
  padding:9px 12px;
  border-radius:999px;
  cursor:pointer;
  transition:transform .18s ease, box-shadow .18s ease, filter .18s ease;
}
.pbtn:hover{ transform:translateY(-2px); box-shadow:0 10px 16px rgba(0,0,0,.10); filter:saturate(1.02) brightness(1.01); }
.pbtn:active{ transform:translateY(-1px); box-shadow:0 8px 12px rgba(0,0,0,.08); }
.pbtn[aria-pressed="true"]{
  background:linear-gradient(135deg,#ff7aa8,#ffb3cd);
  color:#fff;
  border-color:transparent;
}

.result{
  margin-top:12px;
  padding:12px;
  border-radius:14px;
  background:#fff7fb;
  border-left:4px solid var(--accent);
}
.result .total{
  font-size:1.2rem;
  font-weight:900;
}
.breakdown{
  margin-top:8px;
  font-size:.98rem;
}
.breakdown b{ font-weight:900; }

/* å‰²ã‚Šå‹˜ï¼ˆã”ä¸»äººæ§˜ã®ã¿ï¼‰ */
.split{
  margin-top:10px;
  padding:10px;
  border-radius:14px;
  background:#fffafc;
  border:1px dashed var(--border);
}
.split .row{
  display:flex;
  flex-wrap:wrap;
  gap:8px 14px;
  align-items:center;
}
.split .label{ font-weight:900; }
.split .per{
  font-weight:900;
  font-size:1.08rem;
}
.split small{ color:var(--muted); }

.warn{
  margin-top:8px;
  padding:10px 12px;
  border-radius:12px;
  background:#fff3f6;
  border:1px solid rgba(222,63,123,.25);
  color:#7a2a43;
  font-weight:800;
}

/* åŒå“ã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼ˆãƒ©ã‚¸ã‚ªï¼‰ */
.seg{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
}
.seg label{
  display:flex;
  gap:8px;
  align-items:center;
  padding:10px 12px;
  border-radius:999px;
  border:1px solid rgba(222,63,123,.22);
  background:#fff7fb;
  font-weight:900;
  cursor:pointer;
}
.seg input{ transform:scale(1.05); }

.is-disabled{
  opacity:.55;
  filter:grayscale(.05);
}

footer{
  text-align:center;
  color:var(--muted);
  font-size:.86rem;
  padding:18px 10px 26px;
}
</style>
</head>

<body>

<header>
  <div class="badge">æ–™é‡‘ãƒ»ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼</div>
  <h1>ğŸ’° éº»é›€ æ–™é‡‘æ¡ˆå†…</h1>
  <p>ã†ã¾ç‰¹åˆ¥æ–™é‡‘ï¼ˆ19:00ã€œ21:00ï¼‰ã«ã‚‚å¯¾å¿œ</p>
</header>

<nav class="nav" aria-label="ãƒšãƒ¼ã‚¸å†…ãƒŠãƒ“">
  <a href="index.html" class="secondary">â† ãƒãƒ¼ã‚¿ãƒ«ã¸æˆ»ã‚‹</a>
  <a href="#calc">ğŸ§® è¨ˆç®—ã™ã‚‹</a>
  <a href="#fees">ğŸ“Œ æ–™é‡‘è¡¨</a>
  <a href="#uma">ğŸ´ ã†ã¾ç‰¹åˆ¥æ–™é‡‘</a>
  <a href="#notes">âš  æ³¨æ„äº‹é …</a>
</nav>

<main>

  <section id="calc">
    <h2>æ–™é‡‘ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ï¼ˆå…¥åŠ›ã™ã‚‹ã¨è‡ªå‹•è¨ˆç®—ï¼‰</h2>

    <div class="sim">
      <p class="price" style="margin:0 0 8px;">ğŸ’° æ–™é‡‘ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼</p>

      <div class="field" style="margin-bottom:10px;">
        <label>åŒå“ã‚ªãƒ—ã‚·ãƒ§ãƒ³</label>
        <div class="seg" role="radiogroup" aria-label="åŒå“ã‚ªãƒ—ã‚·ãƒ§ãƒ³">
          <label>
            <input type="radio" name="partnerMode" value="maid" checked>
            ãƒ¡ã‚¤ãƒ‰åŒå“
          </label>
          <label>
            <input type="radio" name="partnerMode" value="uma">
            ã†ã¾åˆ©ç”¨ï¼ˆ19:00ã€œ21:00ãƒ»åŒå“æ–™ãªã—ï¼‰
          </label>
        </div>
        <div class="mini">â€»ã†ã¾åˆ©ç”¨ä¸­ã¯åŒå“æ–™ãŒç™ºç”Ÿã—ã¾ã›ã‚“ï¼ˆãƒ¡ã‚¤ãƒ‰åŒå“äººæ•°ã¯0åå›ºå®šï¼‰</div>
      </div>

      <div class="sim-grid">
        <div class="field">
          <label for="guests">ã”ä¸»äººæ§˜ã®äººæ•°</label>
          <select id="guests" aria-describedby="guestsHelp">
            <option value="1">1å</option>
            <option value="2">2å</option>
            <option value="3" selected>3å</option>
            <option value="4">4å</option>
            <option value="5">5å</option>
            <option value="6">6å</option>
            <option value="7">7å</option>
            <option value="8">8å</option>
          </select>
          <div class="mini" id="guestsHelp">ãƒ—ãƒ«ãƒ€ã‚¦ãƒ³ã§äººæ•°ã‚’é¸æŠ</div>
        </div>

        <div class="field" id="maidsField">
          <label for="maids">ãƒ¡ã‚¤ãƒ‰ã•ã‚“ã®äººæ•°</label>
          <select id="maids" aria-describedby="maidsHelp">
            <option value="0">0åï¼ˆåŒå“ãªã—ï¼‰</option>
            <option value="1" selected>1å</option>
            <option value="2">2åï¼ˆæœ€å¤§ï¼‰</option>
          </select>
          <div class="mini" id="maidsHelp">åŒå“ã¯æœ€å¤§2åã¾ã§ï¼ˆã†ã¾åˆ©ç”¨ä¸­ã¯0åå›ºå®šï¼‰</div>
        </div>

        <div class="field">
          <label for="minutes">ã”åˆ©ç”¨æ™‚é–“ï¼ˆåˆ†ï¼‰</label>
          <input id="minutes" type="number" inputmode="numeric" min="30" max="720" step="10" value="120" aria-describedby="minutesHelp">
          <div class="mini" id="minutesHelp">30åˆ†ä»¥ä¸Šã€‚30åˆ†å˜ä½ã§åˆ‡ã‚Šä¸Šã’è¨ˆç®—</div>

          <div class="presets" role="group" aria-label="åˆ©ç”¨æ™‚é–“ãƒ—ãƒªã‚»ãƒƒãƒˆ">
            <button class="pbtn" type="button" data-min="120" aria-pressed="true">120</button>
            <button class="pbtn" type="button" data-min="150" aria-pressed="false">150</button>
            <button class="pbtn" type="button" data-min="180" aria-pressed="false">180</button>
            <button class="pbtn" type="button" data-min="210" aria-pressed="false">210</button>
            <button class="pbtn" type="button" data-min="240" aria-pressed="false">240</button>
            <button class="pbtn" type="button" data-min="270" aria-pressed="false">270</button>
            <button class="pbtn" type="button" data-min="300" aria-pressed="false">300</button>
          </div>
          <div class="mini">â€»æŠ¼ã™ã¨åˆ†å…¥åŠ›ãŒåˆ‡ã‚Šæ›¿ã‚ã‚Šã¾ã™</div>
        </div>
      </div>

      <div class="sim-actions">
        <button class="btn" type="button" id="calcBtn">è¨ˆç®—ã™ã‚‹</button>
        <button class="btn secondary" type="button" id="resetBtn">ãƒªã‚»ãƒƒãƒˆ</button>
      </div>

      <div class="result" aria-live="polite">
        <div class="total">åˆè¨ˆï¼š<span id="total">â€”</span></div>
        <div class="mini" id="meta">â€”</div>
        <div class="breakdown" id="breakdown"></div>

        <div class="split">
          <div class="row">
            <span class="label">ã”ä¸»äººæ§˜ 1äººã‚ãŸã‚Šï¼š</span>
            <span class="per" id="perGuest">â€”</span>
            <small id="perGuestNote">â€”</small>
          </div>
          <div class="mini">â€»ç«¯æ•°ã¯ã€Œå††å˜ä½ã€ã§åˆ‡ã‚Šä¸Šã’è¡¨ç¤ºï¼ˆåˆè¨ˆã¨ä¸€è‡´ã—ãªã„å ´åˆã¯ç«¯æ•°èª¿æ•´ã§å¯¾å¿œã—ã¦ãã ã•ã„ï¼‰</div>
        </div>

        <div class="warn" id="warn" style="display:none;"></div>
      </div>

      <div class="mini" style="margin-top:8px;">
        <b>è¨ˆç®—ãƒ«ãƒ¼ãƒ«ï¼š</b>
        å“ä»£ 2,000å††ï¼ˆåˆå›ã®ã¿ï¼‰ï¼3æ™‚é–“ä»¥ä¸Šã§å“ä»£ç„¡æ–™ï¼ã”ä¸»äººæ§˜ 30åˆ†1,000å††/äººï¼
        <span id="maidRuleText">ãƒ¡ã‚¤ãƒ‰åŒå“ 30åˆ†1,000å††/äººï¼ˆæœ€å¤§2åï¼‰</span>ï¼30åˆ†å˜ä½ã§åˆ‡ã‚Šä¸Šã’
      </div>
    </div>

    <p class="note" style="margin-top:10px;">
      â€»ã†ã¾åˆ©ç”¨ï¼ˆ19:00ã€œ21:00ï¼‰ã¯ã€ŒåŒå“æ–™ãªã—ã€ã§è¨ˆç®—ã•ã‚Œã¾ã™ã€‚<br>
      â€»21:00ä»¥é™ã«ç¶™ç¶šã™ã‚‹å ´åˆã¯ã€åŒå“æ–™ãŒç™ºç”Ÿã—ãƒ¡ã‚¤ãƒ‰ã•ã‚“ã¸ãƒãƒˆãƒ³ã‚¿ãƒƒãƒã§ãã¾ã™ã€‚
    </p>
  </section>

  <section id="fees">
    <h2>æ–™é‡‘è¡¨</h2>

    <div class="pricebox">
      <p class="price">â–  åˆå›ã”åˆ©ç”¨ï¼š120åˆ†ã€œ</p>
      <p class="price">â–  ã”å»¶é•·ï¼š30åˆ†ã€œï¼ˆ30åˆ†å˜ä½ï¼‰</p>
      <p class="note">â€»è¡¨ç¤ºã¯ã™ã¹ã¦ç¨è¾¼ã§ã™ã€‚</p>
    </div>

    <div class="pricebox" style="margin-top:12px;">
      <p class="price">â‘  å…¨è‡ªå‹•éº»é›€å“è²¸å‡ºæ–™ï¼š2,000å††ï¼ˆç¨è¾¼ï¼‰</p>
      <p class="note">â€»åˆå›ã®ã¿ç™ºç”Ÿã—ã¾ã™ã€‚å»¶é•·æ™‚ã¯å†ç™ºç”Ÿã—ã¾ã›ã‚“ã€‚</p>
      <p class="note">â€»<strong>3æ™‚é–“ä»¥ä¸Šã®ã”åˆ©ç”¨äºˆç´„ã§ã€è²¸å‡ºæ–™ã¯ç„¡æ–™</strong>ã¨ãªã‚Šã¾ã™ã€‚</p>

      <p class="price" style="margin-top:10px;">â‘¡ ã”ä¸»äººæ§˜ï¼š30åˆ† 1,000å††ï¼ˆç¨è¾¼ï¼‰ï¼äºº</p>
      <p class="note">â€»é€šå¸¸æ–™é‡‘ã¨åŒæ§˜ã®æ™‚é–“åˆ¶æ–™é‡‘ã§ã™ã€‚</p>

      <p class="price" style="margin-top:10px;">â‘¢ ãƒ¡ã‚¤ãƒ‰ã•ã‚“åŒå“æ–™ï¼š30åˆ† 1,000å††ï¼ˆç¨è¾¼ï¼‰ï¼äºº</p>
      <p class="note">â€»åŒå“ã§ãã‚‹ãƒ¡ã‚¤ãƒ‰ã¯æœ€å¤§2åã¾ã§ã€‚</p>
    </div>

    <div class="example">
      <strong>æ–™é‡‘ä¾‹ï¼ˆãƒ¡ã‚¤ãƒ‰åŒå“ï¼‰</strong><br>
      ğŸ‘‘ ã”ä¸»äººæ§˜3åï¼‹ãƒ¡ã‚¤ãƒ‰ã•ã‚“1åï¼120åˆ†ï¼ˆ2æ™‚é–“ï¼‰ã®å ´åˆ<br><br>
      å“ä»£ï¼š2,000å††<br>
      ã”ä¸»äººæ§˜3åï¼š1,000å†† Ã— 4ï¼ˆ30åˆ†å˜ä½ï¼‰ Ã— 3å ï¼ 12,000å††<br>
      ãƒ¡ã‚¤ãƒ‰ã•ã‚“1ååŒå“æ–™ï¼š1,000å†† Ã— 4 ï¼ 4,000å††<br><br>
      âœ… åˆè¨ˆï¼š<strong>18,000å††ï¼ˆç¨è¾¼ï¼‰</strong><br>
      <span class="note">â€»120åˆ†ã¯ã€Œ30åˆ†Ã—4æ ã€ã¨ã—ã¦è¨ˆç®—ã—ã¾ã™ã€‚</span>
    </div>
  </section>

  <section id="uma">
    <h2>ã†ã¾ç‰¹åˆ¥æ–™é‡‘ï¼ˆ19:00ã€œ21:00é™å®šï¼‰</h2>

    <div class="pricebox">
      <p class="price">â–  ã†ã¾ã®å®šç¾©</p>
      <ul>
        <li>ãƒ¡ã‚¤ãƒ‰ã•ã‚“ã§ã¯ãªã„ç‰¹åˆ¥ã‚µãƒãƒ¼ãƒˆæ </li>
        <li>åŒå“æ–™ãªã—</li>
        <li>åŸºæœ¬ç„¡å£</li>
        <li>ç¨¼åƒæ™‚é–“ï¼š19:00ï½21:00é™å®š</li>
      </ul>
      <p class="note">â€»ã†ã¾ç¨¼åƒä¸­ã¯ã€Œãƒ¡ã‚¤ãƒ‰åŒå“æ–™ã€ãŒç™ºç”Ÿã—ã¾ã›ã‚“ã€‚</p>
      <p class="note">â€»21:00ä»¥é™ã«ç¶™ç¶šã™ã‚‹å ´åˆã¯ã€åŒå“æ–™ãŒç™ºç”Ÿã—ãƒ¡ã‚¤ãƒ‰ã•ã‚“ã¸ãƒãƒˆãƒ³ã‚¿ãƒƒãƒã§ãã¾ã™ã€‚</p>
    </div>

    <div class="example">
      <strong>æ–™é‡‘ä¾‹ï¼ˆã†ã¾åˆ©ç”¨ï¼‰</strong><br>
      ğŸ‘‘ ã”ä¸»äººæ§˜3åï¼120åˆ†ï¼ˆ2æ™‚é–“ï¼‰ã®å ´åˆï¼ˆã†ã¾ï¼åŒå“æ–™ãªã—ï¼‰<br><br>
      å“ä»£ï¼š2,000å††<br>
      ã”ä¸»äººæ§˜3åï¼š1,000å†† Ã— 4ï¼ˆ30åˆ†å˜ä½ï¼‰ Ã— 3å ï¼ 12,000å††<br>
      åŒå“æ–™ï¼š0å††<br><br>
      âœ… åˆè¨ˆï¼š<strong>14,000å††ï¼ˆç¨è¾¼ï¼‰</strong><br>
      <span class="note">â€»åŒæ¡ä»¶ã®ã€Œãƒ¡ã‚¤ãƒ‰åŒå“ï¼ˆ1åï¼‰ã€ã‚ˆã‚Š 4,000å††ãŠå¾—ã€‚</span>
    </div>
  </section>

  <section id="notes">
    <h2>æ³¨æ„äº‹é …</h2>
    <ul>
      <li>å¥å…¨ãªã‚¢ãƒŸãƒ¥ãƒ¼ã‚ºãƒ¡ãƒ³ãƒˆã‚µãƒ¼ãƒ“ã‚¹ã§ã™</li>
      <li>é‡‘éŠ­ã®ã‚„ã‚Šå–ã‚Šãƒ»è³­åšè¡Œç‚ºã¯ç¦æ­¢ã§ã™</li>
      <li>ãŠå±‹æ•·ã®å“ã‚’å¤§åˆ‡ã«ã™ã‚‹ãŸã‚ã€å¼·æ‰“ã¯ã”é æ…®ãã ã•ã„ã€‚â€»ç‰Œã¯ãã£ã¨å„ªã—ãç½®ã„ã¦ã„ãŸã ã‘ã¾ã™ã¨å¹¸ã„ã§ã™ã€‚</li>
      <li>ä»–ã®ãŠå®¢æ§˜ã®ã”è¿·æƒ‘ã«ãªã‚‹è¡Œç‚ºã¯ã”é æ…®ãã ã•ã„</li>
      <li>ãƒ¡ã‚¤ãƒ‰ã•ã‚“ã¸ã®éåº¦ãªè¦æ±‚ã¯ç¦æ­¢ã§ã™</li>
    </ul>
  </section>

</main>

<footer>
  concept cafe POãƒ»TORO
</footer>

<script>
(function(){
  const RATE_PER_30_GUEST = 1000;
  const RATE_PER_30_MAID  = 1000;
  const TABLE_FEE         = 2000;
  const TABLE_FREE_MIN    = 180;
  const MAID_MAX          = 2;

  const $ = (id)=>document.getElementById(id);

  const guestsEl = $("guests");
  const maidsEl  = $("maids");
  const minutesEl= $("minutes");

  const totalEl  = $("total");
  const metaEl   = $("meta");
  const breakdownEl = $("breakdown");
  const warnEl   = $("warn");

  const perGuestEl = $("perGuest");
  const perGuestNoteEl = $("perGuestNote");

  const presetButtons = Array.from(document.querySelectorAll(".pbtn"));
  const partnerRadios = Array.from(document.querySelectorAll('input[name="partnerMode"]'));

  const maidsField = $("maidsField");
  const maidRuleText = $("maidRuleText");

  function yen(n){ return n.toLocaleString("ja-JP") + "å††"; }
  function ceilTo30(min){ return Math.ceil(min / 30) * 30; }

  function getMode(){
    return partnerRadios.find(r=>r.checked)?.value || "maid";
  }

  function setPressedPresetFromMinutes(min){
    presetButtons.forEach(btn=>{
      const v = Number(btn.dataset.min);
      btn.setAttribute("aria-pressed", String(v === min));
    });
  }

  function applyModeUI(){
    const mode = getMode();
    const isUma = (mode === "uma");

    if(isUma){
      maidsEl.value = "0";
      maidsEl.setAttribute("disabled","disabled");
      maidsField.classList.add("is-disabled");
      maidRuleText.textContent = "ã†ã¾åˆ©ç”¨ä¸­ã¯åŒå“æ–™ãªã—ï¼ˆãƒ¡ã‚¤ãƒ‰åŒå“ã¯0åå›ºå®šï¼‰";
    }else{
      maidsEl.removeAttribute("disabled");
      maidsField.classList.remove("is-disabled");
      maidRuleText.textContent = "ãƒ¡ã‚¤ãƒ‰åŒå“ 30åˆ†1,000å††/äººï¼ˆæœ€å¤§2åï¼‰";
    }
  }

  function calc(){
    warnEl.style.display = "none";
    warnEl.textContent = "";

    applyModeUI();

    const mode = getMode();
    const isUma = (mode === "uma");

    let guests = Number(guestsEl.value);
    let maids  = Number(maidsEl.value);
    let minutes= Number(minutesEl.value);

    if(!Number.isFinite(guests) || guests < 1){
      guests = 1; guestsEl.value = "1";
      warnEl.textContent = "ã”ä¸»äººæ§˜äººæ•°ã¯1åä»¥ä¸Šã§é¸æŠã—ã¦ãã ã•ã„ã€‚";
      warnEl.style.display = "block";
    }

    if(isUma) maids = 0;

    if(!Number.isFinite(maids) || maids < 0) maids = 0;
    if(maids > MAID_MAX){
      maids = MAID_MAX;
      maidsEl.value = String(MAID_MAX);
      warnEl.textContent = "ãƒ¡ã‚¤ãƒ‰ã•ã‚“åŒå“ã¯æœ€å¤§2åã¾ã§ã§ã™ã€‚2åã«è£œæ­£ã—ã¾ã—ãŸã€‚";
      warnEl.style.display = "block";
    }
    if(!Number.isFinite(minutes) || minutes < 30){
      minutes = 30; minutesEl.value = 30;
      warnEl.textContent = "ã”åˆ©ç”¨æ™‚é–“ã¯30åˆ†ä»¥ä¸Šã§å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚";
      warnEl.style.display = "block";
    }

    const billedMinutes = ceilTo30(minutes);
    const slots = billedMinutes / 30;

    const tableFee  = (minutes >= TABLE_FREE_MIN) ? 0 : TABLE_FEE;
    const guestsFee = RATE_PER_30_GUEST * slots * guests;
    const maidsFee  = isUma ? 0 : (RATE_PER_30_MAID * slots * maids);

    const total = tableFee + guestsFee + maidsFee;

    totalEl.textContent = yen(total);
    metaEl.textContent =
      `å…¥åŠ›ï¼š${minutes}åˆ† â†’ è«‹æ±‚ã¯${billedMinutes}åˆ†ï¼ˆ30åˆ†Ã—${slots}æ ï¼‰ï¼ã”ä¸»äººæ§˜${guests}åãƒ»åŒå“ï¼š${isUma ? "ã†ã¾ï¼ˆåŒå“æ–™ãªã—ï¼‰" : ("ãƒ¡ã‚¤ãƒ‰" + maids + "å")}`;

    breakdownEl.innerHTML =
      `å†…è¨³ï¼šå“ä»£ <b>${yen(tableFee)}</b> ï¼‹ ã”ä¸»äººæ§˜ <b>${yen(guestsFee)}</b> ï¼‹ ${isUma ? "åŒå“ <b>0å††</b>" : ("ãƒ¡ã‚¤ãƒ‰åŒå“ <b>" + yen(maidsFee) + "</b>")}`;

    if(minutes < TABLE_FREE_MIN){
      const remain = TABLE_FREE_MIN - minutes;
      const msg = `ã‚ã¨${remain}åˆ†ã§ã€Œ3æ™‚é–“ä»¥ä¸Šã€ã«ãªã‚Šã€å“ä»£ãŒç„¡æ–™ã«ãªã‚Šã¾ã™ã€‚`;
      warnEl.textContent = warnEl.style.display === "block"
        ? (warnEl.textContent + " " + msg)
        : msg;
      warnEl.style.display = "block";
    }

    setPressedPresetFromMinutes(minutes);

    const per = Math.ceil(total / guests);
    perGuestEl.textContent = yen(per);
    perGuestNoteEl.textContent = `ï¼ˆã”ä¸»äººæ§˜${guests}åã§å‰²ã‚‹ï¼‰`;
  }

  function reset(){
    partnerRadios.forEach(r=>r.checked = (r.value === "maid"));
    guestsEl.value = "3";
    maidsEl.value = "1";
    minutesEl.value = 120;

    totalEl.textContent = "â€”";
    metaEl.textContent = "â€”";
    breakdownEl.textContent = "";
    warnEl.style.display = "none";
    warnEl.textContent = "";

    perGuestEl.textContent = "â€”";
    perGuestNoteEl.textContent = "â€”";

    setPressedPresetFromMinutes(120);
    calc();
  }

  $("calcBtn").addEventListener("click", calc);
  $("resetBtn").addEventListener("click", reset);

  presetButtons.forEach(btn=>{
    btn.addEventListener("click", ()=>{
      const v = Number(btn.dataset.min);
      minutesEl.value = String(v);
      setPressedPresetFromMinutes(v);
      calc();
    });
  });

  [guestsEl, maidsEl, minutesEl].forEach(el=>{
    el.addEventListener("input", calc);
    el.addEventListener("change", calc);
  });

  partnerRadios.forEach(r=>{
    r.addEventListener("change", calc);
  });

  setPressedPresetFromMinutes(Number(minutesEl.value));
  calc();
})();
</script>

</body>
</html>
